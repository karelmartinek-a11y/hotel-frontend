{% extends "base.html" %}

{% block title %}ASC Hotel Chodov — Dashboard{% endblock %}

{% block head_extra %}
<style>
  :root {
    --brand-1: #0ea5e9;
    --brand-2: #38bdf8;
    --brand-3: #7dd3fc;
  }
</style>
{% endblock %}

{% block content %}
<div class="page">
  <div class="container admin-shell">
    {% include "admin_sidebar.html" %}

    <main class="admin-main">
      <div class="stack" style="gap:14px;">
        <div class="row" style="justify-content:space-between;align-items:flex-end;flex-wrap:wrap;">
          <div style="display:flex;flex-direction:column;gap:6px;">
            <div style="font-size:20px;font-weight:850;">Dashboard</div>
            <div style="color:var(--muted);">Přehled hlášení a stavu zařízení.</div>
          </div>
          <div style="display:flex;gap:10px;flex-wrap:wrap;align-items:flex-end;">
            <a href="/admin/reports/findings" class="btn">Ztráty a nálezy</a>
            <a href="/admin/reports/issues" class="btn">Závady</a>
            <a href="/admin/devices" class="btn solid">Zařízení</a>
          </div>
        </div>

        <div class="card pad" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:12px;">
          <div class="card pad" style="background:linear-gradient(180deg,#e0f2fe,#ffffff);border-color:#bae6fd;">
            <div style="display:flex;justify-content:space-between;align-items:center;">
              <div>
                <div style="font-size:13px;color:var(--muted);">Otevřené nálezy</div>
                <div style="font-size:28px;font-weight:800;margin-top:4px;">{{ stats.open_finds }}</div>
              </div>
              <span class="badge" style="background:#e0f2fe;border-color:#bae6fd;">FIND</span>
            </div>
            <div style="margin-top:8px;color:var(--muted);font-size:12px;">Poslední aktualizace: {{ stats.generated_at_human }}</div>
          </div>

          <div class="card pad" style="background:linear-gradient(180deg,#fef3c7,#ffffff);border-color:#fde68a;">
            <div style="display:flex;justify-content:space-between;align-items:center;">
              <div>
                <div style="font-size:13px;color:var(--muted);">Otevřené závady</div>
                <div style="font-size:28px;font-weight:800;margin-top:4px;">{{ stats.open_issues }}</div>
              </div>
              <span class="badge" style="background:#fef3c7;border-color:#fde68a;">ISSUE</span>
            </div>
            <div style="margin-top:8px;color:var(--muted);font-size:12px;">Poslední aktualizace: {{ stats.generated_at_human }}</div>
          </div>

          <div class="card pad" style="background:linear-gradient(180deg,#ecfeff,#ffffff);border-color:#bae6fd;">
            <div style="display:flex;justify-content:space-between;align-items:center;">
              <div>
                <div style="font-size:13px;color:var(--muted);">Zařízení ke schválení</div>
                <div style="font-size:28px;font-weight:800;margin-top:4px;">{{ stats.pending_devices }}</div>
              </div>
              <span class="badge pending"><span class="b-dot" aria-hidden="true"></span><span>Pending</span></span>
            </div>
            <div style="margin-top:8px;color:var(--muted);font-size:12px;">Poslední aktualizace: {{ stats.generated_at_human }}</div>
          </div>
        </div>

        <div class="card pad" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:14px;">
          <div>
            <div style="font-weight:800;">Rychlé akce</div>
            <div style="margin-top:10px;display:grid;gap:10px;">
              <a href="/admin/reports/findings?status=OPEN" class="btn">Otevřené nálezy</a>
              <a href="/admin/reports/issues?status=OPEN" class="btn">Otevřené závady</a>
              <a href="/admin/reports?status=DONE" class="btn">Vyřízené (DONE)</a>
              <a href="/admin/devices" class="btn solid">Zařízení</a>
            </div>
          </div>
          <div>
            <div style="font-weight:800;">Stav systému</div>
            <div style="margin-top:10px;display:grid;gap:10px;">
              <div class="card pad" style="display:flex;justify-content:space-between;align-items:center;">
                <div>
                  <div style="font-weight:700;">API</div>
                  <div style="color:var(--muted);font-size:12px;">{{ stats.api_base }}</div>
                </div>
                <span class="badge active"><span class="b-dot" aria-hidden="true"></span><span>OK</span></span>
              </div>
              <div class="card pad" style="display:flex;justify-content:space-between;align-items:center;">
                <div>
                  <div style="font-weight:700;">Databáze</div>
                  <div style="color:var(--muted);font-size:12px;">PostgreSQL 15 (Docker)</div>
                </div>
                {% if stats.db_ok %}
                  <span class="badge active"><span class="b-dot" aria-hidden="true"></span><span>OK</span></span>
                {% else %}
                  <span class="badge revoked"><span class="b-dot" aria-hidden="true"></span><span>PROBLÉM</span></span>
                {% endif %}
              </div>
              <div class="card pad" style="display:flex;justify-content:space-between;align-items:center;">
                <div>
                  <div style="font-weight:700;">Média</div>
                  <div style="color:var(--muted);font-size:12px;">/var/lib/hotelapp/media</div>
                </div>
                {% if stats.media_ok %}
                  <span class="badge active"><span class="b-dot" aria-hidden="true"></span><span>OK</span></span>
                {% else %}
                  <span class="badge revoked"><span class="b-dot" aria-hidden="true"></span><span>PROBLÉM</span></span>
                {% endif %}
              </div>
              <div class="card pad">
                <div style="font-weight:700;">Poznámka</div>
                <div style="margin-top:6px;color:var(--muted);font-size:13px;">Přístup k fotografiím je chráněn admin session. Veřejně nejsou dostupné.</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>
</div>
{% endblock %}
